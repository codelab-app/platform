{
  "overrides": [
    {
      "files": ["*.ts", "*.tsx"],
      "rules": {
        "@nx/enforce-module-boundaries": [
          "error",
          {
            "enforceBuildableLibDependency": true,
            "allow": [],
            "depConstraints": [
              //
              // This is a map of key & their possible values
              //
              // "scope": ["frontend", "backend", "shared", "codegen"]
              // "layer": ["domain", "application", "infra", "presentation"]
              // "type": ["abstract", "concrete", "test"]
              // "projectType": ["application", "library"]
              {
                "sourceTag": "type:abstract",
                "onlyDependOnLibsWithTags": ["type:abstract"]
              },
              // Concrete cannot depend on abstract
              {
                "sourceTag": "type:abstract",
                "notDependOnLibsWithTags": ["type:concrete"]
              },
              // Frontend cannot depend on backend
              {
                "sourceTag": "scope:frontend",
                "notDependOnLibsWithTags": ["scope:backend"]
              },
              // Backend cannot depend on frontend
              {
                "sourceTag": "scope:backend",
                "notDependOnLibsWithTags": ["scope:frontend"]
              },
              // Shared cannot import from domain
              {
                "sourceTag": "scope:shared",
                "notDependOnLibsWithTags": ["layer:domain", "layer:application"]
              },
              {
                "sourceTag": "scope:frontend",
                "onlyDependOnLibsWithTags": [
                  "scope:frontend",
                  "scope:shared",
                  "scope:codegen",
                  "type:abstract"
                ]
              },
              {
                "sourceTag": "scope:backend",
                "onlyDependOnLibsWithTags": [
                  "scope:backend",
                  "scope:shared",
                  "scope:codegen"
                ]
              },
              // Application project type can only import from library
              {
                "sourceTag": "projectType:application",
                "onlyDependOnLibsWithTags": ["projectType:library"]
              },
              // Library project type can only import from application
              {
                "sourceTag": "projectType:library",
                "notDependOnLibsWithTags": ["projectType:application"]
              },
              {
                "sourceTag": "type:test",
                "onlyDependOnLibsWithTags": ["type:test", "type:abstract"]
              },

              // Domain layer cannot depend on application
              {
                "sourceTag": "layer:domain",
                "notDependOnLibsWithTags": ["layer:application"]
              },
              {
                "allSourceTags": ["layer:domain", "scope:frontend"],
                "onlyDependOnLibsWithTags": [
                  "layer:domain",
                  "type:abstract",
                  "layer:infra",
                  "scope:shared"
                ]
              },
              {
                "allSourceTags": ["layer:domain", "scope:backend"],
                "onlyDependOnLibsWithTags": [
                  "layer:domain",
                  "type:abstract",
                  "layer:infra",
                  "scope:shared"
                ]
              },
              {
                "sourceTag": "layer:application",
                "onlyDependOnLibsWithTags": [
                  "layer:domain",
                  "layer:application",
                  "layer:infra",
                  "type:abstract",
                  "scope:shared"
                ]
              },
              {
                "sourceTag": "scope:shared",
                "onlyDependOnLibsWithTags": ["scope:shared", "type:abstract"]
              },
              // {
              //   "sourceTag": "layer:domain:frontend",
              //   "onlyDependOnLibsWithTags": [
              //     "scope:shared",
              //     "layer:domain:frontend",
              //     "layer:infra",
              //     "type:abstract"
              //   ]
              // },
              // {
              //   "sourceTag": "layer:domain:backend",
              //   "onlyDependOnLibsWithTags": [
              //     "layer:domain:backend",
              //     "layer:application:backend",
              //     "scope:shared",
              //     "layer:infra",
              //     "type:abstract"
              //   ]
              // },
              {
                "sourceTag": "scope:publishable",
                "onlyDependOnLibsWithTags": ["scope:publishable"]
              }
            ]
          }
        ]
      }
    }
  ]
}
